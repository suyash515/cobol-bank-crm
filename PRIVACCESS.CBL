       IDENTIFICATION DIVISION.
       PROGRAM-ID. PRIVACCESS.

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-Z16.
       OBJECT-COMPUTER. IBM-Z16.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT ACCESS-LOG-FILE ASSIGN TO PRIVACC
               ORGANIZATION IS SEQUENTIAL
               ACCESS MODE IS SEQUENTIAL
               FILE STATUS IS WS-FILE-STATUS.

       DATA DIVISION.

       FILE SECTION.
       FD  ACCESS-LOG-FILE.
       01  ACCESS-LOG-RECORD.
           05  AL-TIMESTAMP        PIC X(26).
           05  AL-EMPLOYEE-ID      PIC X(08).
           05  AL-CUSTOMER-ID      PIC X(10).
           05  AL-ACCESS-TYPE      PIC X(10).
           05  AL-FIELD-NAME       PIC X(20).

       WORKING-STORAGE SECTION.

       01  WS-FILE-STATUS         PIC XX.
       01  WS-RESPONSE            PIC X(100).

       EXEC SQL INCLUDE SQLCA END-EXEC.

       EXEC SQL BEGIN DECLARE SECTION END-EXEC.
       01  HV-EMPLOYEE-ID         PIC X(08).
       01  HV-CUSTOMER-ID         PIC X(10).
       01  HV-ACCESS-TYPE         PIC X(10).
       01  HV-FIELD-NAME          PIC X(20).
       01  HV-TIMESTAMP           PIC X(26).
       EXEC SQL END DECLARE SECTION END-EXEC.

       LINKAGE SECTION.
       01  DFHCOMMAREA.
           05  LK-EMPLOYEE-ID      PIC X(08).
           05  LK-CUSTOMER-ID      PIC X(10).
           05  LK-ACCESS-TYPE      PIC X(10).
           05  LK-FIELD-NAME       PIC X(20).

       PROCEDURE DIVISION.

       MAIN-LOGIC.
           OPEN OUTPUT ACCESS-LOG-FILE

           MOVE LK-EMPLOYEE-ID  TO HV-EMPLOYEE-ID
           MOVE LK-CUSTOMER-ID  TO HV-CUSTOMER-ID
           MOVE LK-ACCESS-TYPE  TO HV-ACCESS-TYPE
           MOVE LK-FIELD-NAME   TO HV-FIELD-NAME
           MOVE FUNCTION CURRENT-TIMESTAMP TO HV-TIMESTAMP

           MOVE HV-TIMESTAMP    TO AL-TIMESTAMP
           MOVE HV-EMPLOYEE-ID  TO AL-EMPLOYEE-ID
           MOVE HV-CUSTOMER-ID  TO AL-CUSTOMER-ID
           MOVE HV-ACCESS-TYPE  TO AL-ACCESS-TYPE
           MOVE HV-FIELD-NAME   TO AL-FIELD-NAME

           WRITE ACCESS-LOG-RECORD

           IF WS-FILE-STATUS = "00"
               MOVE "ACCESS LOG ENTRY WRITTEN" TO WS-RESPONSE
           ELSE
               MOVE "ERROR WRITING ACCESS LOG" TO WS-RESPONSE
               DISPLAY "FILE STATUS: " WS-FILE-STATUS
           END-IF

           DISPLAY WS-RESPONSE

           CLOSE ACCESS-LOG-FILE

           GOBACK.
